<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Filename</th>
      <th>Example</th>
      <th>UniXcoder</th>
      <th>OpenAI</th>
      <th>GPT Evaluation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>serve_model_llm</td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>from potassium import Potassium, Request, Response<br>from transformers import AutoTokenizer<br>from auto_gptq import AutoGPTQForCausalLM<br><br>MODEL_NAME_OR_PATH = "TheBloke/vicuna-33B-GPTQ"<br>MODEL_BASENAME = "vicuna-33b-GPTQ-4bit--1g.act.order"<br>DEVICE = "cuda:0"<br><br>app = Potassium("my_app") <br><br>@app.init<br>def init() -&gt; dict:<br>    """Initialize the application with the model and tokenizer."""<br>    tokenizer = AutoTokenizer.from_pretrained(MODEL_NAME_OR_PATH, use_fast=True)<br>    model = AutoGPTQForCausalLM.from_quantized(MODEL_NAME_OR_PATH,<br>        model_basename=MODEL_BASENAME,  <br>        use_safetensors=True,<br>        trust_remote_code=True,<br>        device=DEVICE,<br>        use_triton=False,</code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>import json<br><br>import gradio as gr<br>from langchain.chains import RetrievalQA<br>from langchain.chat_models import ChatOpenAI<br>from langchain.embeddings.openai import OpenAIEmbeddings<br>from langchain.vectorstores.faiss import FAISS<br><br>from lanarky import Lanarky<br>from lanarky.adapters.langchain.routing import LangchainAPIRouter<br>from lanarky.clients import StreamingClient<br><br>app = Lanarky()<br>router = LangchainAPIRouter()<br><br><br>@router.post("/chat")<br>def chat() -&gt; RetrievalQA:<br>    db = FAISS.load_local("db/", OpenAIEmbeddings())<br>    return RetrievalQA.from_chain_type(<br>        ChatOpenAI(streaming=True),<br>        retriever=db.as_retriever(search_kwargs={"k": 2}),<br>        return_source_documents=True,<br>    )<br><br><br>app.include_router(router)<br><br><br>SOURCE_DOCUMENT_TEMPLATE = """<br>&lt;details&gt;&lt;summary&gt;&lt;b&gt;Source {idx}&lt;/b&gt;&lt;/summary&gt;{page_content}&lt;/details&gt;<br>"""</code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>from typing import List<br><br>from fastapi import FastAPI<br>from fastapi._compat import PYDANTIC_V2<br>from fastapi.testclient import TestClient<br>from pydantic import BaseModel, ConfigDict, Field<br><br>app = FastAPI()<br><br><br>class Model(BaseModel):<br>    name: str = Field(alias="alias")<br><br><br>class ModelNoAlias(BaseModel):<br>    name: str<br><br>    if PYDANTIC_V2:<br>        model_config = ConfigDict(<br>            json_schema_extra={<br>                "description": (<br>                    "response_model_by_alias=False is basically a quick hack, to support "<br>                    "proper OpenAPI use another model with the correct field names"<br>                )<br>            }<br>        )<br>    else:<br><br>        class Config:<br>            schema_extra = {<br>                "description": (<br>                    "response_model_by_alias=False is basically a quick hack, to support "<br>                    "proper OpenAPI use another model with the correct field names"<br>                )<br>            }</code></pre></div></td>
      <td>No Decision</td>
    </tr>
    <tr>
      <th>1</th>
      <td>auth_implemented</td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>    CertificateFetchError,<br>    ExpiredIdTokenError,<br>    InvalidIdTokenError,<br>    RevokedIdTokenError,<br>    UserDisabledError,<br>)<br><br>from app import models<br><br>PUBLIC_ROUTES = [<br>    "/api/auth/signup", <br>]<br><br><br>class FirebaseAuthMiddleware:<br>    async def __call__(self, request: Request, call_next, *args, **kwargs):<br>        # Check if the route is public<br>        if (<br>            not request.url.path.startswith("/api")<br>            or request.method == "OPTIONS"<br>            or any([request.url.path.startswith(r) for r in PUBLIC_ROUTES])</code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>from fastapi import APIRouter, Depends, HTTPException<br>from fastapi.security import OAuth2PasswordRequestForm<br>from sqlalchemy.ext.asyncio import AsyncSession<br><br>from app.api.deps import get_session<br>from app.core.security import authenticate, create_access_token<br>from app.schemas.token import Token<br><br>router = APIRouter(tags=["Login"])<br><br><br>@router.post("/login/", response_model=Token)<br>async def login(<br>    data: OAuth2PasswordRequestForm = Depends(),<br>    session: AsyncSession = Depends(get_session),<br>):<br>    user = await authenticate(session, email=data.username, password=data.password)<br>    if user is None:<br>        raise HTTPException(status_code=400, detail="Incorrect email or password")<br>    if not user.is_active:<br>        raise HTTPException(status_code=400, detail="Inactive user")<br>    return {"access_token": create_access_token(user), "token_type": "bearer"}</code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>app = FastAPI(**app_configs, lifespan=lifespan)<br><br>app.add_middleware(<br>    CORSMiddleware,<br>    allow_origins=settings.CORS_ORIGINS,<br>    allow_origin_regex=settings.CORS_ORIGINS_REGEX,<br>    allow_credentials=True,<br>    allow_methods=("GET", "POST", "PUT", "PATCH", "DELETE", "OPTIONS"),<br>    allow_headers=settings.CORS_HEADERS,<br>)<br><br>if settings.ENVIRONMENT.is_deployed:<br>    sentry_sdk.init(<br>        dsn=settings.SENTRY_DSN,<br>        environment=settings.ENVIRONMENT,<br>    )<br><br><br>@app.get("/healthcheck", include_in_schema=False)<br>async def healthcheck() -&gt; dict[str, str]:<br>    return {"status": "ok"}<br><br><br>app.include_router(auth_router, prefix="/auth", tags=["Auth"])<br>app.include_router(<br>    external_service_router, prefix="/external-service", tags=["External Service Calls"]<br>)</code></pre></div></td>
      <td>OpenAI</td>
    </tr>
    <tr>
      <th>2</th>
      <td>uvicorn_main</td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>def main():<br>    uvicorn.run(<br>        "fluento.main:app", port=5001, reload=True, workers=1, timeout_keep_alive=30<br>    )<br></code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>@app.post("/job/del", tags=["schedule"], summary="移除任务")<br>async def remove_schedule(<br>        job_id: str = Body(..., title="任务id", embed=True)<br>):<br>    res = Schedule.get_job(job_id=job_id)<br>    if not res:<br>        return resp_fail(msg=f"not found job {job_id}")<br>    Schedule.remove_job(job_id)<br>    return resp_ok()<br><br># 暂停和恢复任务 暂时没看<br><br><br>if __name__ == "__main__":<br>    import uvicorn<br><br>    # 官方推荐是用命令后启动 uvicorn main:app --host=127.0.0.1 --port=8150 --reload<br>    uvicorn.run(app='main:app', host="127.0.0.1", port=8151, reload=False, debug=True)</code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>#!/usr/bin/env python<br># -*- coding: utf-8 -*-<br># @Time    : 2020/10/15 16:24<br># @Author  : CoderCharm<br># @File    : main.py<br># @Software: PyCharm<br># @Github  : github/CoderCharm<br># @Email   : wg_python@163.com<br># @Desc    :<br><br>"""<br>pip install uvicorn<br># 推荐启动方式 main指当前文件名字 app指FastAPI实例化后对象名称<br>uvicorn main:app --host=127.0.0.1 --port=8010 --reload<br><br>类似flask 工厂模式创建<br># 生产启动命令 去掉热重载 (可用supervisor托管后台运行)<br><br>在main.py同文件下下启动<br>uvicorn main:app --host=127.0.0.1 --port=8010 --workers=4<br><br># 同样可以也可以配合gunicorn多进程启动  main.py同文件下下启动 默认127.0.0.1:8000端口<br>gunicorn main:app -w 4 -k uvicorn.workers.UvicornWorker -b 127.0.0.1:8020<br><br>"""<br><br><br>from core.server import create_app<br><br><br>app = create_app()<br><br>if __name__ == "__main__":<br>    import uvicorn<br><br>    # 输出所有的路由<br>    for route in app.routes:<br>        if hasattr(route, "methods"):<br>            print({'path': route.path, 'name': route.name, 'methods': route.methods})<br><br>    uvicorn.run(app='main:app', host="127.0.0.1", port=8010, reload=True, debug=True)</code></pre></div></td>
      <td>OpenAI</td>
    </tr>
    <tr>
      <th>3</th>
      <td>auth_outline</td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>        # Get the authorization header<br>        authorization_header = request.headers.get("Authorization")<br><br>        # Ensure the authorization header is present<br>        if not authorization_header:<br>                raise HTTPException(status_code=400, detail="Missing auth token")<br><br>        # Try to verify the token and get the user<br>        try:<br>            # Check if we have the token<br>            pass <br>        except ValueError:<br>            raise HTTPException(status_code=400, detail="Invalid auth token")<br><br>        # Run the function<br>        return await call_next(request)</code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>async def __call__(self, request: Request) -&gt; Optional[str]:<br>        authorization = request.headers.get("Authorization")<br>        scheme, param = get_authorization_scheme_param(authorization)<br>        if not authorization or scheme.lower() != "bearer":<br>            if self.auto_error:<br>                raise HTTPException(<br>                    status_code=HTTP_401_UNAUTHORIZED,<br>                    detail="Not authenticated",<br>                    headers={"WWW-Authenticate": "Bearer"},<br>                )<br>            else:<br>                return None<br>        return param<br><br><br>class OAuth2AuthorizationCodeBearer(OAuth2):<br>    """<br>    OAuth2 flow for authentication using a bearer token obtained with an OAuth2 code<br>    flow. An instance of it would be used as a dependency.<br>    """</code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>async def __call__(<br>        self, request: Request<br>    ) -&gt; Optional[HTTPAuthorizationCredentials]:<br>        authorization = request.headers.get("Authorization")<br>        scheme, credentials = get_authorization_scheme_param(authorization)<br>        if not (authorization and scheme and credentials):<br>            if self.auto_error:<br>                raise HTTPException(<br>                    status_code=HTTP_403_FORBIDDEN, detail="Not authenticated"<br>                )<br>            else:<br>                return None<br>        if scheme.lower() != "digest":<br>            raise HTTPException(<br>                status_code=HTTP_403_FORBIDDEN,<br>                detail="Invalid authentication credentials",<br>            )<br>        return HTTPAuthorizationCredentials(scheme=scheme, credentials=credentials)</code></pre></div></td>
      <td>OpenAI</td>
    </tr>
    <tr>
      <th>4</th>
      <td>generate_openapi</td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code><br># Set operation IDs to route names<br>app = main.app<br>for route in app.routes:<br>    if isinstance(route, APIRoute):<br>        route.operation_id = route.name<br>        route.tags = route.endpoint.__module__.split(".")[2:]<br><br># Generate OpenAPI schema<br>openapi_def = app.openapi()<br><br># Write to file<br>with open(output_file, "w") as f:<br>    f.write(json.dumps(openapi_def, indent=4))</code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>def get_openapi_operation_metadata(<br>    *, route: routing.APIRoute, method: str, operation_ids: Set[str]<br>) -&gt; Dict[str, Any]:<br>    operation: Dict[str, Any] = {}<br>    if route.tags:<br>        operation["tags"] = route.tags<br>    operation["summary"] = generate_operation_summary(route=route, method=method)<br>    if route.description:<br>        operation["description"] = route.description<br>    operation_id = route.operation_id or route.unique_id<br>    if operation_id in operation_ids:<br>        message = (<br>            f"Duplicate Operation ID {operation_id} for function "<br>            + f"{route.endpoint.__name__}"<br>        )<br>        file_name = getattr(route.endpoint, "__globals__", {}).get("__file__")<br>        if file_name:<br>            message += f" at {file_name}"<br>        warnings.warn(message, stacklevel=1)<br>    operation_ids.add(operation_id)<br>    operation["operationId"] = operation_id<br>    if route.deprecated:<br>        operation["deprecated"] = route.deprecated<br>    return operation</code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>import json<br>from pathlib import Path<br><br>file_path = Path("./openapi.json")<br>openapi_content = json.loads(file_path.read_text())<br><br>for path_data in openapi_content["paths"].values():<br>    for operation in path_data.values():<br>        tag = operation["tags"][0]<br>        operation_id = operation["operationId"]<br>        to_remove = f"{tag}-"<br>        new_operation_id = operation_id[len(to_remove) :]<br>        operation["operationId"] = new_operation_id<br><br>file_path.write_text(json.dumps(openapi_content))</code></pre></div></td>
      <td>OpenAI</td>
    </tr>
    <tr>
      <th>5</th>
      <td>healthcheck</td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>from fastapi import APIRouter<br><br>router = APIRouter(tags=["health"])<br><br><br>@router.get("/health", responses={200: {"description": "Health check"}})<br>def health():<br>    return {"status": "ok"}</code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>from fastapi import APIRouter<br><br>from fastapi_skeleton.api.routes import heartbeat, prediction<br><br>api_router = APIRouter()<br>api_router.include_router(heartbeat.router, tags=["health"], prefix="/health")<br>api_router.include_router(prediction.router, tags=[<br>                          "prediction"], prefix="/model")</code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>from fastapi import APIRouter<br><br>from app.api.health import router as health_router<br>from app.api.v1 import router as v1_router<br><br>router = APIRouter(prefix="/api")<br>router.include_router(v1_router)<br>router.include_router(health_router)</code></pre></div></td>
      <td>OpenAI</td>
    </tr>
    <tr>
      <th>6</th>
      <td>dependency_injection2</td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>@inject<br>def login(state: str, config=Depends(Provide[Container.config])) -&gt; RedirectResponse:<br>    # TODO Use the state variable of the client<br>    # TODO export URLS<br>    params = {<br>        "response_type": "code",<br>        "scope": "openid email profile",<br>        "client_id": "prompto",<br>        "redirect_uri": config["oidc"]["redirect_url"],<br>        "state": state,<br>        "nonce": "123123",  # TODO implement using nonce <br>    }<br>    auth_server_url = config["oidc"]["auth_url"] + "?" + urlencode(params)<br>    return RedirectResponse(url=auth_server_url)<br><br><br>@router.get(<br>    "/callback"<br>)  # Required for localhost testing since keycloak has /callback for localhost<br>@router.get(<br>    "/auth/callback",</code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>def get_swagger_ui_oauth2_redirect_html() -&gt; HTMLResponse:<br>    """<br>    Generate the HTML response with the OAuth2 redirection for Swagger UI.<br><br>    You normally don't need to use or change this.<br>    """<br>    # copied from https://github.com/swagger-api/swagger-ui/blob/v4.14.0/dist/oauth2-redirect.html<br>    html = """<br>    &lt;!doctype html&gt;<br>    &lt;html lang="en-US"&gt;<br>    &lt;head&gt;<br>        &lt;title&gt;Swagger UI: OAuth2 Redirect&lt;/title&gt;<br>    &lt;/head&gt;<br>    &lt;body&gt;<br>    &lt;script&gt;<br>        'use strict';<br>        function run () {<br>            var oauth2 = window.opener.swaggerUIRedirectOauth2;<br>            var sentState = oauth2.state;<br>            var redirectUrl = oauth2.redirectUrl;<br>            var isValid, qp, arr;<br><br>            if (/code|token|error/.test(window.location.hash)) {<br>                qp = window.location.hash.substring(1).replace('?', '&amp;');<br>            } else {<br>                qp = location.search.substring(1);<br>            }</code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>router = APIRouter(prefix="/login", tags=["login"])<br><br><br>@router.post("/access-token", response_model=schemas.Token)<br>def login_access_token(<br>    db: Session = Depends(deps.get_db), form_data: OAuth2PasswordRequestForm = Depends()<br>):<br>    """OAuth2 compatible token login, get an access token for future requests."""<br>    user = crud.user.authenticate(db, email=form_data.username, password=form_data.password)<br>    if not user:<br>        raise HTTPException(<br>            status_code=status.HTTP_400_BAD_REQUEST, detail="Incorrect email or password."<br>        )<br>    elif not crud.user.is_active(user):<br>        raise HTTPException(status_code=status.HTTP_400_BAD_REQUEST, detail="Inactive user.")<br>    return {"access_token": security.create_access_token(str(user.id)), "token_type": "bearer"}<br><br><br>@router.post("/test-token", response_model=schemas.User)<br>def test_token(current_user: models.User = Depends(deps.get_current_active_user)):<br>    """<br>    Test access token<br>    """<br>    return current_user</code></pre></div></td>
      <td>OpenAI</td>
    </tr>
    <tr>
      <th>7</th>
      <td>translation_api</td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>        "Translate in Video Call",<br>        {<br>            "Text": data.text,<br>            "Translation": translation,<br>            "Native Language": native_language,<br>            "Native Language Code": native_language_code,<br>        },<br>        request=request,<br>    )<br><br>    return schemas.TranslationResult(translation=translation) </code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>def amis_html(<br>        self,<br>        template_path: str = "",<br>        locale: str = "zh_CN",<br>        cdn: str = "https://unpkg.com",<br>        pkg: str = "amis@1.10.2",<br>        site_title: str = "Amis",<br>        site_icon: str = "",<br>        theme: str = "cxd",<br>    ):<br>        """Render html template"""<br>        template_path = template_path or self.__default_template_path__<br>        theme_css = f'&lt;link href="{cdn}/{pkg}/sdk/{theme}.css" rel="stylesheet"/&gt;' if theme != "cxd" else ""<br>        return amis_templates(template_path).safe_substitute(<br>            {<br>                "AmisSchemaJson": self.amis_json(),<br>                "locale": locale.replace("_", "-"),  # Fix #50<br>                "cdn": cdn,<br>                "pkg": pkg,<br>                "site_title": site_title,<br>                "site_icon": site_icon,<br>                "theme": theme,<br>                "theme_css": theme_css,<br>            }<br>        )<br><br><br>class Divider(AmisNode):<br>    """Dividing line"""</code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>expected_schema = {<br>    "components": {<br>        "schemas": {<br>            "HTTPValidationError": {<br>                "properties": {<br>                    "detail": {<br>                        "items": {"$ref": "#/components/schemas/ValidationError"},<br>                        "title": "Detail",<br>                        "type": "array",<br>                    }<br>                },<br>                "title": "HTTPValidationError",<br>                "type": "object",<br>            },<br>            "ValidationError": {<br>                "properties": {<br>                    "loc": {<br>                        "items": {"anyOf": [{"type": "string"}, {"type": "integer"}]},<br>                        "title": "Location",<br>                        "type": "array",<br>                    },<br>                    "msg": {"title": "Message", "type": "string"},<br>                    "type": {"title": "Error " "Type", "type": "string"},<br>                },<br>                "required": ["loc", "msg", "type"],<br>                "title": "ValidationError",<br>                "type": "object",<br>            },<br>        }<br>    },<br>    "info": {"title": "FastAPI", "version": "0.1.0"},<br>    "openapi": "3.1.0",<br>    "paths": {<br>        "/foo": {<br>            "get": {<br>                "operationId": "foo_handler_foo_get",<br>                "parameters": [<br>                    {<br>                        "in": "query",<br>                        "name": "client_id",<br>                        "required": True,<br>                        "schema": {"title": "Client Id", "type": "string"},<br>                    },<br>                ],<br>                "responses": {<br>                    "200": {<br>                        "content": {"application/json": {"schema": {}}},<br>                        "description": "Successful " "Response",<br>                    },<br>                    "422": {<br>                        "content": {<br>                            "application/json": {<br>                                "schema": {<br>                                    "$ref": "#/component</code></pre></div></td>
      <td>No Decision</td>
    </tr>
    <tr>
      <th>8</th>
      <td>snippet_schema</td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>import datetime<br><br><br>class SchedulingTimeRequest(BaseModel):<br>    # Battery charge in percentage [0-1] once the drive starts <br>    battery_charge: float<br><br>    # When the car will start to drive<br>    drive_start_time: datetime.datetime<br><br><br>class SchedulingTimeResponse(BaseModel):<br>    # When the car should charge<br>    recommended_starting_time: datetime.datetime</code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>class PRsRepository(BaseModel):<br>    pullRequests: PullRequests<br><br><br>class PRsResponseData(BaseModel):<br>    repository: PRsRepository<br><br><br>class PRsResponse(BaseModel):<br>    data: PRsResponseData<br><br><br># Sponsors<br><br><br>class SponsorEntity(BaseModel):<br>    login: str<br>    avatarUrl: str<br>    url: str<br><br><br>class Tier(BaseModel):<br>    name: str<br>    monthlyPriceInDollars: float<br><br><br>class SponsorshipAsMaintainerNode(BaseModel):<br>    sponsorEntity: SponsorEntity<br>    tier: Tier<br><br><br>class SponsorshipAsMaintainerEdge(BaseModel):<br>    cursor: str<br>    node: SponsorshipAsMaintainerNode<br><br><br>class SponsorshipAsMaintainer(BaseModel):<br>    edges: List[SponsorshipAsMaintainerEdge]<br><br><br>class SponsorsUser(BaseModel):<br>    sponsorshipsAsMaintainer: SponsorshipAsMaintainer<br><br><br>class SponsorsResponseData(BaseModel):<br>    user: SponsorsUser<br><br><br>class SponsorsResponse(BaseModel):<br>    data: SponsorsResponseData<br><br><br>class Settings(BaseSettings):<br>    input_token: SecretStr<br>    github_repository: str<br>    httpx_timeout: int = 30</code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>from datetime import datetime<br>from typing import List, Optional<br><br>from pydantic import BaseModel, Field<br><br>from fastapi_amis_admin.utils.pydantic import ORMModelMixin, model_update_forward_refs<br><br><br>class PkSchemaMixin(ORMModelMixin):<br>    id: int = Field(default=None, primary_key=True, nullable=False)<br><br><br>class CreateTimeSchemaMixin(BaseModel):<br>    create_time: datetime = Field(default_factory=datetime.utcnow, title="Create Time")<br><br><br>class UserSchemaBase(PkSchemaMixin, CreateTimeSchemaMixin):<br>    username: str = Field(title="Username")<br>    password: str = Field(default="", title="Password")<br>    address: Optional[List[str]] = Field(<br>        None,<br>        title="Address",<br>    )<br>    attach: Optional[dict] = Field(None, title="Attach")<br><br><br>class UserSchema(UserSchemaBase):<br>    articles: List["ArticleSchema"] = []<br><br><br>class CategorySchema(PkSchemaMixin, CreateTimeSchemaMixin):<br>    name: str = Field(title="CategoryName")<br>    description: str = Field(default="", title="CategoryDescription")</code></pre></div></td>
      <td>No Decision</td>
    </tr>
    <tr>
      <th>9</th>
      <td>get_rooms_api</td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>@router.get("/rooms/{room_id}")<br>def get_room(request: Request, room_id: str) -&gt; schemas.room:<br>    """Get room info"""<br>    user = request.state.user<br>    room = models.get_room(room_id)<br>    return schemas.Room(    <br>        id=room.room_id,<br>        start_time=room.start_time,<br>        end_time=room.get_end_time(),<br>        num_rsvps=len(room.rsvps),<br>        has_user_rsvped=user.id in room.rsvps,<br>    )</code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>@app.get("/pets/", response_model=List[PetOut])<br>async def read_pets():<br>    user = UserDB(<br>        email="johndoe@example.com",<br>        hashed_password="secrethashed",<br>    )<br>    pet1 = PetDB(name="Nibbler", owner=user)<br>    pet2 = PetDB(name="Zoidberg", owner=user)<br>    return [pet1, pet2]<br><br><br>client = TestClient(app)<br><br><br>def test_filter_top_level_model():<br>    response = client.post(<br>        "/users", json={"email": "johndoe@example.com", "password": "secret"}<br>    )<br>    assert response.json() == {"email": "johndoe@example.com"}<br><br><br>def test_filter_second_level_model():<br>    response = client.get("/pets/1")<br>    assert response.json() == {<br>        "name": "Nibbler",<br>        "owner": {"email": "johndoe@example.com"},<br>    }<br><br><br>def test_list_of_models():<br>    response = client.get("/pets/")<br>    assert response.json() == [<br>        {"name": "Nibbler", "owner": {"email": "johndoe@example.com"}},<br>        {"name": "Zoidberg", "owner": {"email": "johndoe@example.com"}},<br>    ]</code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>@router.get("/{user_id}")<br>def read_user_by_id(<br>    user_id: int, session: SessionDep, current_user: CurrentUser<br>) -&gt; UserOut:<br>    """<br>    Get a specific user by id.<br>    """<br>    user = session.get(User, user_id)<br>    if user == current_user:<br>        return user  # type: ignore<br>    if not current_user.is_superuser:<br>        raise HTTPException(<br>            # TODO: Review status code<br>            status_code=400,<br>            detail="The user doesn't have enough privileges",<br>        )<br>    return user  # type: ignore</code></pre></div></td>
      <td>No Decision</td>
    </tr>
    <tr>
      <th>10</th>
      <td>dependency_injection</td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>    if not chat_rq.id:<br>        raise HTTPException(<br>            status_code=status.HTTP_400_BAD_REQUEST,<br>            detail="ID should be provided when continuing chat",<br>        )<br><br>    agent: BaseAgent = chat_service.receive_agent(AgentType.DEBUG)<br>    history = await agent.continue_chat(session, chat_rq.id, chat_rq.message)<br><br>    # Create response<br>    return ChatResponse( <br>        history_id=history.history_id,<br>        messages=history.messages,<br>    )<br><br><br>class FeedbackRequest(BaseModel):<br>    history_id: UUID<br>    message_id: UUID<br>    feedback_type: FeedbackType<br></code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>from unittest.mock import AsyncMock, MagicMock<br><br>import pytest<br>from openai.types.chat import chat_completion, chat_completion_chunk<br><br>from lanarky.adapters.openai.resources import (<br>    AsyncOpenAI,<br>    ChatCompletion,<br>    ChatCompletionChunk,<br>    ChatCompletionResource,<br>    Message,<br>)<br><br><br>@pytest.mark.asyncio<br>async def test_chat_completion_resource_stream_response():<br>    async def mock_completion_chunk_stream():<br>        yield ChatCompletionChunk(<br>            id="chat-completion-id",<br>            created=1700936386,<br>            model="gpt-3.5-turbo-0613",<br>            object="chat.completion.chunk",<br>            choices=[<br>                chat_completion_chunk.Choice(<br>                    index=0,<br>                    finish_reason=None,<br>                    delta=chat_completion_chunk.ChoiceDelta(<br>                        content="Hello! How can I assist you today?"<br>                    ),<br>                )<br>            ],<br>        )</code></pre></div></td>
      <td><div style="text-align: left; width: 450px; word-wrap: break-word; white-space: normal; overflow: hidden"><pre><code>from abc import abstractmethod<br>from typing import Any, Generator<br><br>from openai import AsyncOpenAI<br>from openai.types.chat import ChatCompletion, ChatCompletionChunk<br>from pydantic import BaseModel, Field<br><br>from lanarky.utils import model_dump<br><br><br>class Message(BaseModel):<br>    role: str = Field(pattern=r"^(user|assistant)$")<br>    content: str<br><br><br>class SystemMessage(BaseModel):<br>    role: str = "system"<br>    content: str<br><br><br>class OpenAIResource:<br>    """Base class for OpenAI resources."""<br><br>    def __init__(self, client: AsyncOpenAI = None):<br>        self._client = client or AsyncOpenAI()<br><br>    @abstractmethod<br>    async def stream_response(<br>        self, *args: Any, **kwargs: dict[str, Any]<br>    ) -&gt; Generator[str, None, None]:<br>        ...<br><br><br>class ChatCompletionResource(OpenAIResource):<br>    """OpenAIResource class for chat completions."""</code></pre></div></td>
      <td>OpenAI</td>
    </tr>
  </tbody>
</table>