- Defines a function `upload_image` that takes an optional argument `file`, which is of type `UploadFile`. This parameter represents the image being uploaded by the user. - The local storage solution for temporary files is presented here. In production environments, cloud storage services like Alibaba Cloud OSS or Tencent Cloud COS are commonly used instead. - A unique identifier (MD5 hash value) should be calculated and recorded to avoid storing duplicate resources. - If the directory where images will be saved doesn't exist yet, it gets created using the `os.makedirs()` method. - The extension of the uploaded file is extracted from its name using Python's pathlib module. - Using the `NamedTemporaryFile()` class, a new file object is generated in the specified location with the same extension as the original file. - The contents of the input file stream are copied into this newly created file using the `shutil.copyfileobj()` method. - Finally, the response containing the URL of the uploaded image is returned using Flask's built-in `resp.ok()` method.