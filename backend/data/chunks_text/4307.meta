{"original_code": "def test_middleware():\n    client = TestClient(app, base_url=\"https://testserver\")\n    response = client.get(\"/\")\n    assert response.status_code == 200, response.text\n\n    client = TestClient(app)\n    response = client.get(\"/\", follow_redirects=False)\n    assert response.status_code == 307, response.text\n    assert response.headers[\"location\"] == \"https://testserver/\""}