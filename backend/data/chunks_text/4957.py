- Defines a function `setup_middleware` that takes an instance of FastAPI as its argument (`app`)
- Inside this function, defines another asynchronous function called `add_process_time_header`, which accepts two arguments: `Request` and `call_next`. This function calculates the processing time for the request using the `time` module's `time()` method, calls the next middleware in the chain with `await call_next(request)`, then adds the calculated processing time to the response headers under the key "X-Process-Time". Finally, it returns the modified response object.
- Uses the built-in `FastAPI` decorator `add_middleware` to register our custom middleware at the application level, passing in the base HTTP middleware class and specifying our new middleware function as the value for the `dispatch` parameter.