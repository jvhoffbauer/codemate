{"original_code": "def test_middleware():\n    response = client.get(\"/large\", headers={\"accept-encoding\": \"gzip\"})\n    assert response.status_code == 200, response.text\n    assert response.text == \"x\" * 4000\n    assert response.headers[\"Content-Encoding\"] == \"gzip\"\n    assert int(response.headers[\"Content-Length\"]) < 4000\n    response = client.get(\"/\")\n    assert response.status_code == 200, response.text"}