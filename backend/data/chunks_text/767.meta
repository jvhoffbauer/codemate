{"original_code": "@asynccontextmanager\nasync def lifespan(_application: FastAPI) -> AsyncGenerator:\n    # Startup\n    pool = aioredis.ConnectionPool.from_url(\n        str(settings.REDIS_URL), max_connections=10, decode_responses=True\n    )\n    redis.redis_client = aioredis.Redis(connection_pool=pool)\n\n    yield\n\n    if settings.ENVIRONMENT.is_testing:\n        return\n    # Shutdown\n    await pool.disconnect()"}