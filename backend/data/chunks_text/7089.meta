{"original_code": "def get_auth_header_from_email(\n    *, client: TestClient, db: Session, email: EmailStr\n) -> dict[str, str]:\n    \"\"\"\n    Return a valid token for the user with given email.\n\n    If the user doesn't exist it is created first.\n    \"\"\"\n    password = random_lower_string()\n    user = crud.user.get_by_email(db, email=email)\n    if not user:\n        user_in_create = UserCreate(email=email, password=password)\n        user = crud.user.create(db, obj_in=user_in_create)\n    else:\n        user_in_update = UserUpdate(password=password)\n        user = crud.user.update(db, db_obj=user, obj_in=user_in_update)\n    return get_auth_header(client=client, email=email, password=password)"}