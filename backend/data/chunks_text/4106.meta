{"original_code": "@needs_py39\ndef test_websocket_with_cookie(app: FastAPI):\n    client = TestClient(app, cookies={\"session\": \"fakesession\"})\n    with pytest.raises(WebSocketDisconnect):\n        with client.websocket_connect(\"/items/foo/ws\") as websocket:\n            message = \"Message one\"\n            websocket.send_text(message)\n            data = websocket.receive_text()\n            assert data == \"Session cookie or query token value is: fakesession\"\n            data = websocket.receive_text()\n            assert data == f\"Message text was: {message}, for item ID: foo\"\n            message = \"Message two\"\n            websocket.send_text(message)\n            data = websocket.receive_text()\n            assert data == \"Session cookie or query token value is: fakesession\"\n            data = websocket.receive_text()\n            assert data == f\"Message text was: {message}, for item ID: foo\""}