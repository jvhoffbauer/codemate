{"original_code": "def probe_ep(ep):\n    @contextlib.asynccontextmanager\n    async def ep_middleware(ctx: JsonRpcContext):\n        ctx.http_response.set_cookie(key=\"ep_middleware_enter\", value=\"1\")\n        yield\n        ctx.http_response.set_cookie(key=\"ep_middleware_exit\", value=\"2\")\n\n    ep.middlewares.append(ep_middleware)\n\n    @contextlib.asynccontextmanager\n    async def method_middleware(ctx: JsonRpcContext):\n        ctx.http_response.set_cookie(key=\"method_middleware_enter\", value=\"3\")\n        yield\n        ctx.http_response.set_cookie(key=\"method_middleware_exit\", value=\"4\")\n\n    @ep.method(middlewares=[method_middleware])\n    def probe(\n        http_response: Response,\n        data: str = Body(..., examples=[\"123\"]),\n    ) -> str:\n        http_response.set_cookie(key=\"probe-cookie\", value=data)\n        http_response.status_code = 404\n        return data\n\n    return ep"}