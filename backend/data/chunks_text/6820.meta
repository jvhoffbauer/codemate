{"original_code": "def create_user_open(session: SessionDep, user_in: UserCreateOpen) -> UserOut:\n    \"\"\"\n    Create new user without the need to be logged in.\n    \"\"\"\n    if not settings.USERS_OPEN_REGISTRATION:\n        raise HTTPException(\n            status_code=403,\n            detail=\"Open user registration is forbidden on this server\",\n        )\n    user = crud.get_user_by_email(session=session, email=user_in.email)\n    if user:\n        raise HTTPException(\n            status_code=400,\n            detail=\"The user with this username already exists in the system\",\n        )\n    user_create = UserCreate.from_orm(user_in)\n    user = crud.create_user(session=session, user_create=user_create)\n    return user  # type: ignore"}