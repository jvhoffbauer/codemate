{"original_code": "def test_websocket_with_header_and_query():\n    client = TestClient(app)\n    with pytest.raises(WebSocketDisconnect):\n        with client.websocket_connect(\"/items/2/ws?q=3&token=some-token\") as websocket:\n            message = \"Message one\"\n            websocket.send_text(message)\n            data = websocket.receive_text()\n            assert data == \"Session cookie or query token value is: some-token\"\n            data = websocket.receive_text()\n            assert data == \"Query parameter q is: 3\"\n            data = websocket.receive_text()\n            assert data == f\"Message text was: {message}, for item ID: 2\"\n            message = \"Message two\"\n            websocket.send_text(message)\n            data = websocket.receive_text()\n            assert data == \"Session cookie or query token value is: some-token\"\n            data = websocket.receive_text()\n            assert data == \"Query parameter q is: 3\"\n            data = websocket.receive_text()\n            assert data == f\"Message text was: {message}, for item ID: 2\""}