{"original_code": "@router.post(\"/\", response_model=User)\ndef create_user(\n    *,\n    user_in: UserCreate,\n    current_user: UserInDB = Depends(get_current_active_superuser),\n):\n    \"\"\"\n    Create new user.\n    \"\"\"\n    bucket = get_default_bucket()\n    user = crud.user.get(bucket, username=user_in.username)\n    if user:\n        raise HTTPException(\n            status_code=400,\n            detail=\"The user with this username already exists in the system.\",\n        )\n    user = crud.user.upsert(bucket, user_in=user_in, persist_to=1)\n    if config.EMAILS_ENABLED and user_in.email:\n        send_new_account_email(\n            email_to=user_in.email, username=user_in.username, password=user_in.password\n        )\n    return user"}