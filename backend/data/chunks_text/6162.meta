{"original_code": "@APP.middleware(\"http\")\nasync def add_datasource(request: Request, call_next):\n    \"\"\"\n    Attach the data source to the request.state.\n    \"\"\"\n    # Retrieve the datas ource from query param.\n    source = data_source(request.query_params.get(\"source\", default=\"jhu\"))\n\n    # Abort with 404 if source cannot be found.\n    if not source:\n        return Response(\"The provided data-source was not found.\", status_code=404)\n\n    # Attach source to request.\n    request.state.source = source\n\n    # Move on...\n    LOGGER.debug(f\"source provided: {source.__class__.__name__}\")\n    response = await call_next(request)\n    return response"}