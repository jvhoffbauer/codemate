{"original_code": "    def _restore_json_schema_fine_component_names(self, data: dict):\n        def update_refs(value):\n            if not isinstance(value, (dict, list)):\n                return\n\n            if isinstance(value, list):\n                for v in value:\n                    update_refs(v)\n                return\n\n            if \"$ref\" not in value:\n                for v in value.values():\n                    update_refs(v)\n                return\n\n            ref = value[\"$ref\"]\n            if ref.startswith(REF_PREFIX):\n                *_, schema = ref.split(REF_PREFIX)\n                new_schema = old2new_schema_name.get(schema, schema)\n                if new_schema != schema:\n                    ref = f\"{REF_PREFIX}{new_schema}\"\n                    value[\"$ref\"] = ref\n\n        # restore components fine names\n        old2new_schema_name = {}\n\n        fine_schema = {}\n        for key, schema in data[\"components\"][\"schemas\"].items():\n            fine_schema_name = schema[\"title\"]\n            old2new_schema_name[key] = fine_schema_name\n            fine_schema[fine_schema_name] = schema\n        data[\"components\"][\"schemas\"] = fine_schema\n\n        update_refs(data)"}