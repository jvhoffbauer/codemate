- This function `get_current_user()` retrieves the current user based on a JWT (JSON Web Token) provided in the request header's 'Authorization' field using FastAPI's dependency injection mechanism. - The function takes an optional parameter `token`, which is passed to the `check_jwt_token` dependency, and returns the decoded payload of the token as a dictionary. - If the token exists but doesn't have a valid sub claim (unique identifier for the user), it raises a `custom_exc.TokenAuthError`. Otherwise, it queries the database using the `User.single_by_id()` method with the value from the'sub' claim as the primary key, returning the corresponding `User` object.