{"original_code": "    async def update(\n        self,\n        session: AsyncSession,\n        *,\n        obj_in: Union[UpdateSchemaType, Dict[str, Any]],\n        db_obj: Optional[ModelType] = None,\n        **kwargs\n    ) -> Optional[ModelType]:\n        db_obj = db_obj or await self.get(session, **kwargs)\n        if db_obj is not None:\n            obj_data = db_obj.dict()\n            if isinstance(obj_in, dict):\n                update_data = obj_in\n            else:\n                update_data = obj_in.dict(exclude_unset=True)\n            for field in obj_data:\n                if field in update_data:\n                    setattr(db_obj, field, update_data[field])\n            session.add(db_obj)\n            await session.commit()\n        return db_obj"}