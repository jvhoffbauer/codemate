{"original_code": "def create_user_open(\n    *,\n    db: Session = Depends(deps.get_db),\n    user_in: schemas.UserCreate,\n):\n    \"\"\"Create new user without the need to be logged in.\"\"\"\n    if not settings.USERS_OPEN_REGISTRATION:\n        raise HTTPException(\n            status_code=status.HTTP_403_FORBIDDEN,\n            detail=\"Open user registration is forbidden on this server.\",\n        )\n    user = crud.user.get_by_email(db, email=user_in.email)\n    if user:\n        raise HTTPException(\n            status_code=status.HTTP_400_BAD_REQUEST,\n            detail=\"A user with this email already exists.\",\n        )\n    return crud.user.create(db, obj_in=user_in)"}