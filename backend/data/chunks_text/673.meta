{"original_code": "    @before_task_publish.connect(weak=False)\n    def publish_task_from_worker_or_request(\n        headers: Dict[str, str], **kwargs: Any\n    ) -> None:\n        \"\"\"\n        Transfer the current ID to the next Celery worker, by adding\n        it as a header.\n\n        This way we're able to tell which process spawned the next task.\n        \"\"\"\n        current = celery_current_id.get()\n        if current:\n            headers[header_key] = current"}