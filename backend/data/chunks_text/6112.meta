{"original_code": "async def test_update_event(\n    async_client: AsyncClient, fake_users, event_counter, models\n):\n    @event.listens_for(models.User, \"before_update\")\n    def receive_before_update(mapper, connection, target):\n        \"listen for the 'before_update' event\"\n        assert isinstance(target, models.User)\n        event_counter.before += 1\n\n    @event.listens_for(models.User, \"after_update\")\n    def receive_after_update(mapper, connection, target):\n        \"listen for the 'after_update' event\"\n        assert isinstance(target, models.User)\n        event_counter.after += 1\n\n    @event.listens_for(models.User.username, \"set\")\n    def receive_set(target, value, old, initiator):\n        \"listen for the 'set' event\"\n        assert isinstance(target, models.User)\n\n    # update one\n    assert event_counter.before == 0\n    assert event_counter.after == 0\n    await test_route_update(async_client, fake_users, models)\n    assert event_counter.before > 0\n    assert event_counter.after == event_counter.before"}