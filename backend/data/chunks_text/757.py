- Defines an async function `extract_entities_by_type()` that takes a `RecordsRequest` object as input and returns a dictionary containing extracted named entities organized by type (e.g., person, organization). - Uses the `Body` decorator to provide an optional request body with an example value. - Initializes an empty list `res` and another list `documents`. - Loops through each item in the `body` parameter using a list comprehension and adds it to the `documents` list along with its ID and text content. - Calls the `extract_entities()` method of the `extractor` instance to perform named entity extraction on the `documents` list. - Creates an empty list `res` to store the final results. - Loops through each result returned by the `extract_entities()` call and creates a new dictionary representing a single document with the original ID and a nested dictionary containing any named entities found during extraction, grouped by their respective types. - Appends this newly created dictionary to the `res` list. - Returns a dictionary containing the resulting list of records.