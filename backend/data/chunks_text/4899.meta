{"original_code": "def config_couchbase(\n    *, username, password, enterprise=False, host=\"couchbase\", port=\"8091\"\n):\n    allowed_username = get_allowed_username(username)\n    assert (\n        username == allowed_username\n    ), f\"Not a valid username: {username}, a valid one would be {allowed_username}\"\n    cluster_url = get_cluster_http_url(host=host, port=port)\n    logger.info(\"before is_couchbase_ready\")\n    assert is_couchbase_ready(cluster_url)\n    logger.info(\"after is_couchbase_ready\")\n\n    logger.info(\"before setup_couchbase_services\")\n    assert setup_couchbase_services(\n        cluster_url=cluster_url,\n        username=COUCHBASE_DEFAULT_USER,\n        password=COUCHBASE_DEFAULT_PASSWORD,\n    ) or setup_couchbase_services(\n        cluster_url=cluster_url, username=username, password=password\n    )\n    logger.info(\"after setup_couchbase_services\")\n\n    logger.info(\"before setup_memory_quota\")\n    assert setup_memory_quota(\n        cluster_url=cluster_url,\n        username=COUCHBASE_DEFAULT_USER,\n        password=COUCHBASE_DEFAULT_PASSWORD,\n        memory_quota_mb=COUCHBASE_MEMORY_QUOTA_MB,\n        fts_memory_quota_mb=COUCHBASE_FTS_MEMORY_QUOTA_MB,\n        index_memory_quota_mb=COUCHBASE_INDEX_MEMORY_QUOTA_MB,\n    ) or setup_memory_quota(\n        cluster_url=cluster_url,\n        username=username,\n        password=password,\n        memory_quota_mb=COUCHBASE_MEMORY_QUOTA_MB,\n        fts_memory_quota_mb=COUCHBASE_FTS_MEMORY_QUOTA_MB,\n        index_memory_quota_mb=COUCHBASE_INDEX_MEMORY_QUOTA_MB,\n    )\n    logger.info(\"after setup_memory_quota\")\n\n    if not enterprise:\n        logger.info(\"before setup_index_storage\")\n        assert setup_index_storage(\n            cluster_url=cluster_url,\n            username=COUCHBASE_DEFAULT_USER,\n            password=COUCHBASE_DEFAULT_PASSWORD,\n        ) or setup_index_storage(\n            cluster_url=cluster_url, username=username, password=password\n        )\n        logger.info(\"after setup_index_storage\")\n\n    logger.info(\"before ensure_couchbase_username_password\")\n    assert ensure_couchbase_username_password(\n        cluster_url=cluster_url, username=username, password=password\n    )\n    logger.info(\"after ensure_couchbase_username_password\")\n    return True"}