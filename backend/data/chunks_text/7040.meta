{"original_code": "@router.post(\"/reset-password\", response_model=schemas.Msg)\ndef reset_password(\n    *,\n    db: Session = Depends(deps.get_db),\n    token: str = Body(),\n    new_password: str = Body()\n):\n    email = verify_password_reset_token(token)\n    if not email:\n        raise HTTPException(\n            status_code=status.HTTP_400_BAD_REQUEST, detail=\"Invalid token.\"\n        )\n    user = crud.user.get_by_email(db, email=email)\n    if not user:\n        raise HTTPException(\n            status_code=status.HTTP_404_NOT_FOUND, detail=\"User not found.\"\n        )\n    if not crud.user.is_active(user):\n        raise HTTPException(\n            status_code=status.HTTP_400_BAD_REQUEST, detail=\"Inactive user.\"\n        )\n    user.hashed_password = get_password_hash(new_password)\n    db.add(user)\n    db.commit()\n    return {\"msg\": \"Password updated successfully.\"}"}