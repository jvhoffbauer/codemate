{"original_code": "async def before_request(\n    request: Request,\n):\n    if request.url.path not in ALLOW_LIST:\n        try:\n            authorization = request.headers.get(\"Authorization\", None)\n            if not authorization:\n                raise NotAuthorized(\"Authorization Headers Required\")\n            token = authorization.split(\" \")[1]\n            content = decode_jwt(token)\n            # staff = await adal.get_or_404(User, json.loads(content[\"sub\"])[\"user\"])\n            # g.staff = staff\n        except NotAuthorized as e:\n            raise e\n        except NotFound as e:\n            raise NotAuthorized(\"no such staff\")\n        except Exception:\n            # TODO: more specific error\n            raise NotAuthorized(\"token not correct\")"}