{"original_code": "def init_db():\n    cluster_url = get_cluster_http_url(\n        host=config.COUCHBASE_HOST, port=config.COUCHBASE_PORT\n    )\n    logging.info(\"before config_couchbase\")\n    config_couchbase(\n        username=config.COUCHBASE_USER,\n        password=config.COUCHBASE_PASSWORD,\n        host=config.COUCHBASE_HOST,\n        port=config.COUCHBASE_PORT,\n    )\n    logging.info(\"after config_couchbase\")\n    # COUCHBASE_USER=\"Administrator\"\n    # COUCHBASE_PASSWORD=\"password\"\n    logging.info(\"before ensure_create_bucket\")\n    ensure_create_bucket(\n        cluster_url=cluster_url,\n        username=config.COUCHBASE_USER,\n        password=config.COUCHBASE_PASSWORD,\n        bucket_name=config.COUCHBASE_BUCKET_NAME,\n        ram_quota_mb=config.COUCHBASE_MEMORY_QUOTA_MB,\n    )\n    logging.info(\"after ensure_create_bucket\")\n    logging.info(\"before get_bucket\")\n    bucket = get_bucket(\n        config.COUCHBASE_USER,\n        config.COUCHBASE_PASSWORD,\n        config.COUCHBASE_BUCKET_NAME,\n        host=config.COUCHBASE_HOST,\n        port=config.COUCHBASE_PORT,\n    )\n    logging.info(\"after get_bucket\")\n    logging.info(\"before ensure_create_primary_index\")\n    ensure_create_primary_index(bucket)\n    logging.info(\"after ensure_create_primary_index\")\n    logging.info(\"before ensure_create_type_index\")\n    ensure_create_type_index(bucket)\n    logging.info(\"after ensure_create_type_index\")\n    logging.info(\"before ensure_create_full_text_indexes\")\n    ensure_create_full_text_indexes(\n        index_dir=config.COUCHBASE_FULL_TEXT_INDEX_DEFINITIONS_DIR,\n        username=config.COUCHBASE_USER,\n        password=config.COUCHBASE_PASSWORD,\n        host=config.COUCHBASE_HOST,\n        port=config.COUCHBASE_FULL_TEXT_PORT,\n    )\n    logging.info(\"after ensure_create_full_text_indexes\")\n    logging.info(\"before ensure_create_couchbase_app_user sync\")\n    ensure_create_couchbase_user(\n        cluster_url=cluster_url,\n        username=config.COUCHBASE_USER,\n        password=config.COUCHBASE_PASSWORD,\n        new_user_id=config.COUCHBASE_SYNC_GATEWAY_USER,\n        new_user_password=config.COUCHBASE_SYNC_GATEWAY_PASSWORD,\n    )\n    logging.info(\"after ensure_create_couchbase_app_user sync\")\n    logging.info(\"before upsert_user first superuser\")\n    user_in = UserCreate(\n        username=config.FIRST_SUPERUSER,\n        password=config.FIRST_SUPERUSER_PASSWORD,\n        email=config.FIRST_SUPERUSER,\n        admin_roles=[RoleEnum.superuser],\n        admin_channels=[config.FIRST_SUPERUSER],\n    )\n    crud.user.upsert(bucket, user_in=user_in, persist_to=1)\n    logging.info(\"after upsert_user first superuser\")"}